<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choose Your Role - Sports Bridge</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
</head>
<body class="registration-page">
    <div class="gradient-primary" style="min-height: 100vh; padding: 20px 0;">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-10 col-lg-8">
                    <div class="card card-hover">
                        <div class="card-header text-center bg-white">
                            <h4 class="mb-0">
                                <i class="fas fa-bridge text-primary"></i> Sports Bridge
                            </h4>
                            <p class="text-muted mt-2">Complete Your Profile - Step 2</p>
                            <div class="progress" style="height: 4px;">
                                <div class="progress-bar" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <!-- Role Selection -->
                            <div class="mb-4">
                                <h5 class="text-center mb-4">Choose Your Role</h5>
                                <div class="row g-3">
                                    <div class="col-md-6 col-lg-3">
                                        <div class="role-card" data-role="ATHLETE">
                                            <i class="fas fa-running role-icon text-primary"></i>
                                            <h6>Athlete</h6>
                                            <small class="text-muted">Track progress & find coaches</small>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-lg-3">
                                        <div class="role-card" data-role="COACH">
                                            <i class="fas fa-whistle role-icon text-success"></i>
                                            <h6>Coach</h6>
                                            <small class="text-muted">Train & mentor athletes</small>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-lg-3">
                                        <div class="role-card" data-role="SPONSOR">
                                            <i class="fas fa-handshake role-icon text-warning"></i>
                                            <h6>Sponsor</h6>
                                            <small class="text-muted">Support talented athletes</small>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-lg-3">
                                        <div class="role-card" data-role="ADMIN">
                                            <i class="fas fa-user-shield role-icon text-danger"></i>
                                            <h6>Admin</h6>
                                            <small class="text-muted">Platform management</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <form id="roleRegistrationForm" method="post" action="/auth/register/complete">
                                <input type="hidden" id="selectedRole" name="role" required>
                                <input type="hidden" name="step" value="2">

                                <!-- Role-specific fields will be shown based on selection -->

                                <!-- Athlete specific fields -->
                                <div id="athleteFields" class="role-specific-fields" style="display: none;">
                                    <h6 class="text-primary mb-3"><i class="fas fa-running"></i> Athlete Information</h6>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="athleteHeight" class="form-label">Height (cm)</label>
                                            <input type="number" class="form-control" id="athleteHeight" name="height" step="0.1">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="athleteWeight" class="form-label">Weight (kg)</label>
                                            <input type="number" class="form-control" id="athleteWeight" name="weight" step="0.1">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="athleteState" class="form-label">State</label>
                                            <input type="text" class="form-control" id="athleteState" name="state">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="athleteDistrict" class="form-label">District</label>
                                            <input type="text" class="form-control" id="athleteDistrict" name="district">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="emergencyContactName" class="form-label">Emergency Contact Name</label>
                                            <input type="text" class="form-control" id="emergencyContactName" name="emergencyContactName">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="emergencyContactPhone" class="form-label">Emergency Contact Phone</label>
                                            <input type="tel" class="form-control" id="emergencyContactPhone" name="emergencyContactPhone">
                                        </div>
                                    </div>
                                    <div class="mb-3 form-check">
                                        <input type="checkbox" class="form-check-input" id="isDisabled" name="isDisabled">
                                        <label class="form-check-label" for="isDisabled">Person with Disability</label>
                                    </div>
                                    <div class="mb-3" id="disabilityTypeField" style="display: none;">
                                        <label for="disabilityType" class="form-label">Disability Type</label>
                                        <input type="text" class="form-control" id="disabilityType" name="disabilityType">
                                    </div>
                                </div>

                                <!-- Coach specific fields -->
                                <div id="coachFields" class="role-specific-fields" style="display: none;">
                                    <h6 class="text-success mb-3"><i class="fas fa-whistle"></i> Coach Information</h6>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="coachAuthority" class="form-label">Certifying Authority</label>
                                            <input type="text" class="form-control" id="coachAuthority" name="authority" placeholder="e.g., SAI, Sports Federation">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="experienceYears" class="form-label">Years of Experience</label>
                                            <input type="number" class="form-control" id="experienceYears" name="experienceYears" min="0">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="coachState" class="form-label">State</label>
                                            <input type="text" class="form-control" id="coachState" name="state">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="coachDistrict" class="form-label">District</label>
                                            <input type="text" class="form-control" id="coachDistrict" name="district">
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="specialization" class="form-label">Specialization</label>
                                        <input type="text" class="form-control" id="specialization" name="specialization" placeholder="e.g., Athletics, Swimming, Cricket">
                                    </div>
                                </div>

                                <!-- Sponsor specific fields -->
                                <div id="sponsorFields" class="role-specific-fields" style="display: none;">
                                    <h6 class="text-warning mb-3"><i class="fas fa-handshake"></i> Sponsor Information</h6>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="companyName" class="form-label">Company/Organization Name</label>
                                            <input type="text" class="form-control" id="companyName" name="companyName">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="industry" class="form-label">Industry</label>
                                            <input type="text" class="form-control" id="industry" name="industry" placeholder="e.g., Technology, Healthcare, Finance">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="sponsorshipBudget" class="form-label">Annual Sponsorship Budget</label>
                                            <select class="form-select" id="sponsorshipBudget" name="sponsorshipBudget">
                                                <option value="">Select Budget Range</option>
                                                <option value="UNDER_50K">Under ₹50,000</option>
                                                <option value="50K_1L">₹50,000 - ₹1,00,000</option>
                                                <option value="1L_5L">₹1,00,000 - ₹5,00,000</option>
                                                <option value="5L_10L">₹5,00,000 - ₹10,00,000</option>
                                                <option value="ABOVE_10L">Above ₹10,00,000</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="preferredSports" class="form-label">Preferred Sports</label>
                                            <input type="text" class="form-control" id="preferredSports" name="preferredSports" placeholder="e.g., Cricket, Football, Athletics">
                                        </div>
                                    </div>
                                </div>

                                <!-- Admin specific fields -->
                                <div id="adminFields" class="role-specific-fields" style="display: none;">
                                    <h6 class="text-danger mb-3"><i class="fas fa-user-shield"></i> Admin Information</h6>
                                    <div class="alert alert-warning">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        <strong>Note:</strong> Admin accounts require approval from existing administrators.
                                    </div>
                                    <div class="mb-3">
                                        <label for="adminCode" class="form-label">Admin Access Code</label>
                                        <input type="password" class="form-control" id="adminCode" name="adminCode" placeholder="Contact existing admin for access code">
                                    </div>
                                    <div class="mb-3">
                                        <label for="adminReason" class="form-label">Reason for Admin Access</label>
                                        <textarea class="form-control" id="adminReason" name="adminReason" rows="3" placeholder="Explain why you need admin access..."></textarea>
                                    </div>
                                </div>

                                <div class="d-grid mt-4">
                                    <button type="submit" class="btn btn-success btn-lg btn-custom">
                                        <i class="fas fa-check-circle"></i> Complete Registration
                                    </button>
                                </div>
                            </form>
                        </div>
                        <div class="card-footer bg-light text-center">
                            <a href="/auth/register" class="btn btn-outline-secondary btn-sm btn-custom">
                                <i class="fas fa-arrow-left"></i> Back to Step 1
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/app.js"></script>
    <script>
        // Role selection and field management
        document.querySelectorAll('.role-card').forEach(card => {
            card.addEventListener('click', function() {
                const role = this.dataset.role;

                // Update selected role
                document.getElementById('selectedRole').value = role;

                // Remove selected class from all cards
                document.querySelectorAll('.role-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');

                // Hide all role-specific fields
                document.querySelectorAll('.role-specific-fields').forEach(field => {
                    field.style.display = 'none';
                });

                // Show relevant fields based on role
                const roleFieldsMap = {
                    'ATHLETE': 'athleteFields',
                    'COACH': 'coachFields',
                    'SPONSOR': 'sponsorFields',
                    'ADMIN': 'adminFields'
                };

                const fieldsId = roleFieldsMap[role];
                if (fieldsId) {
                    document.getElementById(fieldsId).style.display = 'block';
                }
            });
        });

        // Disability type field toggle
        document.getElementById('isDisabled').addEventListener('change', function() {
            const disabilityTypeField = document.getElementById('disabilityTypeField');
            disabilityTypeField.style.display = this.checked ? 'block' : 'none';
        });

        // Pre-select role if coming from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const preSelectedRole = urlParams.get('role');

        if (preSelectedRole) {
            const roleCard = document.querySelector(`[data-role="${preSelectedRole.toUpperCase()}"]`);
            if (roleCard) {
                roleCard.click();
            }
        }

        // Form validation
        document.getElementById('roleRegistrationForm').addEventListener('submit', function(e) {
            const selectedRole = document.getElementById('selectedRole').value;
            if (!selectedRole) {
                e.preventDefault();
                SportsBrewge.showAlert('Please select a role to continue!', 'warning');
                return false;
            }
        });
    </script>
</body>
</html>
