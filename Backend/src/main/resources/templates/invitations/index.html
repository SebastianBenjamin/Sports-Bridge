<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Invitations</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-3">
  <a href="/dashboard" class="btn btn-link">← Back</a>
  <h3>Invitations</h3>
  <div id="list" class="list-group my-3"></div>
  <script>
  async function load(){
    const r = await fetch('/api/invitations/my');
    const el = document.getElementById('list');
    el.innerHTML = '';
    if(!r.ok){ el.textContent = 'Failed to load.'; return; }
    const data = await r.json();
    data.forEach(inv=>{
      const item = document.createElement('div');
      item.className='list-group-item d-flex justify-content-between align-items-center';
      item.innerHTML = `<div>#${inv.id} - Coach ${inv.coach_id} ↔ Player ${inv.player_id} - <strong>${inv.status}</strong></div>`;
      const act = document.createElement('div');
      if(inv.status==='PENDING'){
        const a = document.createElement('button'); a.className='btn btn-sm btn-success me-2'; a.textContent='Accept';
        a.onclick=()=>respond(inv.id,'accept');
        const d = document.createElement('button'); d.className='btn btn-sm btn-outline-danger'; d.textContent='Reject';
        d.onclick=()=>respond(inv.id,'reject');
        act.append(a,d);
      }
      item.appendChild(act);
      el.appendChild(item);
    });
  }
  async function respond(id, action){
    const r = await fetch(`/api/invitations/${id}/respond`, {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({action})});
    const d = await r.json();
    if(!r.ok){ alert(d.error||r.status); return; }
    if(d.roomId){ location.href = `/chat/rooms/${d.roomId}`; return; }
    load();
  }
  load();
  </script>
</body>
</html>
package org.hackcelestial.sportsbridge.Controllers;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
@RequestMapping("/chat")
public class ChatPageController {

    @GetMapping("/rooms/{roomId}")
    public String room(@PathVariable Long roomId) {
        return "chat/room";
    }
}

